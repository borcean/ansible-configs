- name: docker | add official docker repo (centos)
  ansible.builtin.yum_repository:
    name: google-chrome
    description: Google Chrome
    baseurl: https://download.docker.com/linux/centos/docker-ce.repo
    gpgkey: https://download.docker.com/linux/centos/gpg
    gpgcheck: yes
  when: ansible_distribution == "CentOS"

- name: docker | install required package (centos)
  ansible.builtin.package:
    state: present
    name:
      - docker-ce
      - docker-ce-cli
      - containerd.io
      - docker-compose-plugin
  when: ansible_distribution == "CentOS"

- name: docker | install required packages
  ansible.builtin.package:
    state: present
    name:
      - "{{ docker_package }}"
      - "{{ docker_compose_package }}"
  when: ansible_distribution != "CentOS"


- name: docker | install docker-compose-switch (opensuse tumbleweed)
  ansible.builtin.package:
    state: present
    name: docker-compose-switch
  when: ansible_distribution == "openSUSE Tumbleweed"

- name: docker | ensure group exists
  ansible.builtin.group:
    name: docker
    state: present

- name: docker | add jeffrey to docker group
  ansible.builtin.user:
    name: jeffrey
    groups: docker
    append: yes

- name: docker | enable docker service
  ansible.builtin.systemd:
    name: docker
    enabled: yes

# - name: docker | create external network {{docker.external_network}}
#   docker_network:
#     name: "{{docker.external_network}}"

